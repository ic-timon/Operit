# Markdown 聊天记录导入格式说明

本文档介绍 Operit 应用支持的 Markdown 格式聊天记录导入规范。

## 📋 格式概述

Operit 支持从 Markdown 格式文件导入聊天记录。该格式具有以下特点：

- ✅ 人类可读，易于编辑
- ✅ 支持多个对话在同一文件
- ✅ 支持元数据（标题、创建时间）
- ✅ 支持多种角色标记方式
- ✅ 兼容标准 Markdown 语法

## 🔧 基本格式

### 最简单的格式

```markdown
# 对话标题

## User
用户的消息内容

## Assistant
AI 的回复内容

## User
用户的下一条消息

## Assistant
AI 的下一条回复
```

### 必需元素

1. **对话标题**：使用一级标题 `# 标题名称`
2. **角色标记**：使用二级标题 `## 角色名`
3. **消息内容**：角色标记下方的所有内容直到下一个角色标记

## 👤 角色识别规则

### 用户角色（User）

以下任一关键词都会被识别为**用户**：
- `User` 或 `用户`
- `👤` (emoji)
- `System` 或 `系统`（系统消息会被转换为用户消息）

示例：
```markdown
## User
## 用户
## 👤
## System
```

### AI 角色（Assistant）

以下任一关键词都会被识别为 **AI/助手**：
- `Assistant` 或 `助手`
- `AI`
- `🤖` (emoji)

示例：
```markdown
## Assistant
## 助手
## AI
## 🤖
```

> **注意**：角色识别不区分大小写，`user`、`User`、`USER` 均可识别。

## 📝 YAML Front Matter（可选）

您可以在文件开头添加 YAML front matter 来指定元数据：

```markdown
---
title: 对话标题
created: 2024-12-04 17:00:00
---

## User
消息内容...
```

### 支持的元数据字段

| 字段 | 说明 | 格式示例 |
|------|------|----------|
| `title` | 对话标题 | `title: 我的对话` |
| `created` | 创建时间 | `created: 2024-12-04 17:00:00` |

### 支持的日期格式

- `2024-12-04T17:00:00` (ISO 8601)
- `2024-12-04 17:00:00`
- `2024-12-04 17:00`
- `2024-12-04T17:00:00+08:00` (带时区)

## 📚 多对话文件

### 方法一：使用分隔线 `---`

```markdown
# 第一个对话

## User
第一个对话的内容

## Assistant
回复内容

---

# 第二个对话

## User
第二个对话的内容

## Assistant
回复内容
```

### 方法二：直接使用新的一级标题

```markdown
# 第一个对话

## User
内容

## Assistant
回复

# 第二个对话

## User
内容

## Assistant
回复
```

## ✨ 高级特性

### 1. 支持 Markdown 语法

消息内容完全支持 Markdown 格式：

```markdown
## User
请帮我分析以下**代码**：

​```python
def hello():
    print("Hello, World!")
​```

## Assistant
这段代码定义了一个简单的函数：

1. 函数名是 `hello`
2. 功能是打印 "Hello, World!"
3. *非常简洁*
```

### 2. 多行消息内容

每个角色的消息可以包含多行、多段落：

```markdown
## User
我有三个问题：

1. 第一个问题是什么？
2. 第二个问题是什么？
3. 第三个问题是什么？

请逐一回答。

## Assistant
好的，让我逐一回答：

**问题1**：关于第一个问题...

**问题2**：关于第二个问题...

**问题3**：关于第三个问题...
```

### 3. 使用 Emoji 增强可读性

```markdown
# 🎨 设计讨论

## 👤 User
如何设计一个现代化的 UI？

## 🤖 Assistant
现代化 UI 设计的关键要素包括：
- 简洁的布局
- 合适的色彩搭配
- 良好的交互反馈
```

## ⚠️ 注意事项

### 格式要求

1. **必须使用二级标题**：角色标记必须是 `## `（两个井号+空格），不能是 `###` 或 `#`
2. **标题后需要空格**：`## User` ✅  `##User` ❌
3. **内容不能为空**：每个角色至少要有一行内容
4. **角色交替不是必需的**：可以连续多条同一角色的消息

### 常见错误

❌ **错误示例 1**：使用三级标题
```markdown
### User  
<!-- 应该是 ## User -->
```

❌ **错误示例 2**：标题后没有空格
```markdown
##User  
<!-- 应该是 ## User -->
```

❌ **错误示例 3**：角色标记不规范
```markdown
## 用戶  
<!-- "用戶" 是繁体，应该用 "用户" 或 "User" -->
```

### 导入提示

- 导入的对话会自动归类到 **"从 Markdown 导入"** 分组
- 每条消息会自动生成时间戳（递增，间隔 100ms）
- 如果未指定创建时间，将使用导入时的当前时间
- 如果未指定标题，将使用默认标题 "Imported from Markdown"

## 📖 完整示例

请参考同目录下的 `chat_import_markdown_example.md` 文件查看完整示例。

## 🔗 相关文档

- [聊天记录导出格式说明](./chat_export_formats.md)
- [其他导入格式支持](./chat_import_formats.md)
- [JSON 导入格式说明](./chat_import_json.md)

## 🆘 常见问题

**Q: 可以在一个文件中混合不同的对话吗？**  
A: 可以，使用 `---` 分隔或多个 `# ` 标题即可。

**Q: 消息内容可以包含代码块吗？**  
A: 可以，完全支持 Markdown 语法，包括代码块、列表、表格等。

**Q: 如果我的角色名称不在支持列表中怎么办？**  
A: 建议使用标准的 `User` 和 `Assistant`，或者使用 emoji `👤` 和 `🤖`。

**Q: 导入后可以修改吗？**  
A: 可以，导入后的对话可以在应用内正常编辑、删除。

**Q: 支持导出为 Markdown 格式吗？**  
A: 是的，在备份设置中可以选择导出为 Markdown 格式。

---

**最后更新**：2024-12-04  
**版本**：1.0
